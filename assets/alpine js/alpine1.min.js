function cartHandler() {
  return {
    cart: [],
    showSidebar: false,
    get totalItems() {
      return this.cart.reduce((sum, item) => sum + item.qty, 0);
    },
    get totalPrice() {
      return this.cart.reduce((sum, item) => sum + item.price * item.qty, 0);
    },
    addToCart(product) {
      let existingProduct = this.cart.find(
        (item) => item.name === product.name
      );
      if (existingProduct) {
        existingProduct.qty++;
      } else {
        this.cart.push({ ...product, qty: 1 });
      }
      this.showSidebar = true;
    },
    increaseQty(product) {
      product.qty++;
    },
    decreaseQty(product) {
      if (product.qty > 1) {
        product.qty--;
      } else {
        this.cart = this.cart.filter((item) => item.name !== product.name);
      }
    },
    checkout() {
      if (this.cart.length === 0) {
        alert("Keranjang kosong!");
        return;
      }
      alert("Checkout berhasil! Total: Rp " + this.totalPrice.toLocaleString());
      this.cart = [];
      this.showSidebar = false;
    },
  };
}
